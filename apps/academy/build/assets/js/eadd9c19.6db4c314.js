"use strict";(self.webpackChunk_powerhousedao_academy=self.webpackChunk_powerhousedao_academy||[]).push([[9699],{471:(e,t,n)=>{n.d(t,{A:()=>o});const o=n.p+"assets/images/image-3-37dda6f374923c5ca690cca5e907445f.png"},1521:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>r,default:()=>l,frontMatter:()=>i,metadata:()=>o,toc:()=>h});const o=JSON.parse('{"id":"academy/ExampleUsecases/Chatroom/DefineChatroomDocumentModel","title":"Define the chatroom document model","description":"In this tutorial, you will learn how to design your document model and export it to be later used in your Powerhouse project.","source":"@site/docs/academy/03-ExampleUsecases/Chatroom/03-DefineChatroomDocumentModel.md","sourceDirName":"academy/03-ExampleUsecases/Chatroom","slug":"/academy/ExampleUsecases/Chatroom/DefineChatroomDocumentModel","permalink":"/academy/ExampleUsecases/Chatroom/DefineChatroomDocumentModel","draft":false,"unlisted":false,"editUrl":"https://github.com/powerhouse-inc/powerhouse-docs/tree/dev/docs/academy/03-ExampleUsecases/Chatroom/03-DefineChatroomDocumentModel.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{},"sidebar":"academySidebar","previous":{"title":"Create New Powerhouse Project","permalink":"/academy/ExampleUsecases/Chatroom/CreateNewPowerhouseProject"},"next":{"title":"Implement Operation Reducers","permalink":"/academy/ExampleUsecases/Chatroom/ImplementOperationReducers"}}');var a=n(5723),s=n(7474);const i={},r="Define the chatroom document model",d={},h=[{value:"Chatroom document model schema",id:"chatroom-document-model-schema",level:2},{value:"State schema (See next steps)",id:"state-schema-see-next-steps",level:2},{value:"Operations schema (See next steps)",id:"operations-schema-see-next-steps",level:2},{value:"Define the document model",id:"define-the-document-model",level:2}];function c(e){const t={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",mdxAdmonitionTitle:"mdxAdmonitionTitle",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.header,{children:(0,a.jsx)(t.h1,{id:"define-the-chatroom-document-model",children:"Define the chatroom document model"})}),"\n",(0,a.jsx)(t.p,{children:"In this tutorial, you will learn how to design your document model and export it to be later used in your Powerhouse project.\nIf you don't have a document model created yet, have a look at the previous steps of this tutorial to create a new document model."}),"\n",(0,a.jsx)(t.p,{children:"Before you start, make sure you have the Connect application running."}),"\n",(0,a.jsx)(t.h2,{id:"chatroom-document-model-schema",children:"Chatroom document model schema"}),"\n",(0,a.jsxs)(t.p,{children:["We use GraphQL Schema Definition Language (SDL) to define the document model schema. Below, you can see the SDL for the ",(0,a.jsx)(t.code,{children:"ChatRoom"})," document model."]}),"\n",(0,a.jsxs)(t.admonition,{type:"info",children:[(0,a.jsx)(t.mdxAdmonitionTitle,{children:(0,a.jsx)(t.strong,{children:"The State Schema"})}),(0,a.jsxs)(t.p,{children:["This schema contains the data structure of the document model and the basic operations that can be performed on the document model. For more in depth information please visit ",(0,a.jsx)(t.a,{href:"/academy/MasteryTrack/DocumentModelCreation/SpecifyTheStateSchema",children:"State Schema"})]})]}),"\n",(0,a.jsx)(t.h2,{id:"state-schema-see-next-steps",children:"State schema (See next steps)"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-graphql",children:"# Defines a GraphQL type for the state of the chatroom document\ntype ChatRoomState {\n  id: OID! # Unique identifier for the chat-room\n  name: String! # Name of the chat-room\n  description: String # Optional description of the chat-room\n  createdAt: DateTime! # Timestamp of when the chat-room was created\n  createdBy: ID! # Agent ID of the user who created the chat-room\n  messages: [Message!]! # List of messages in the chat-room\n}\n\n# Defines a GraphQL type for the state of a message\ntype Message {\n  id: OID! # Unique identifier for the message\n  sender: Sender! # Agent details of the message sender\n  content: String # Message content\n  sentAt: DateTime! # Timestamp of when the message was sent\n  reactions: [Reaction!] # Reactions to the message\n}\n\n# Defines a GraphQL type for the state of a sender\ntype Sender {\n  id: ID! # Unique identifier for the sender\n  name: String\n  avatarUrl: URL # Allows us to pull the ENS and/or nft of the persons profile\n}\n\n# Defines a GraphQL type for the state of a reaction to a message\ntype Reaction {\n  type: ReactionType! # Type of reaction (one of the predefined emoji)\n  reactedBy: [ID!]! # Agent ID of the user who reacted\n}\n\n# Defines the various predefined emojis to react to a message\nenum ReactionType {\n  THUMBS_UP\n  THUMBS_DOWN\n  LAUGH\n  HEART\n  CRY\n}\n"})}),"\n",(0,a.jsx)(t.h2,{id:"operations-schema-see-next-steps",children:"Operations schema (See next steps)"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-graphql",children:"# add_message\n\ninput AddMessageInput {\n  messageId: OID! # ID of the message that is being added\n  sender: SenderInput! # ID of the user sending the message\n  content: String! # Content of the message\n  sentAt: DateTime!\n}\n\ninput SenderInput {\n  id: ID! # Unique identifier for the sender\n  name: String\n  avatarUrl: URL # Allows us to pull the ENS and/or nft of the persons profile\n}\n\ninput AddEmojiReactionInput {\n  messageId: OID! # ID of the message to which the reaction is being added\n  reactedBy: ID! # ID of the user adding the reaction\n  type: ReactionType! # Type of the reaction (emoji)\n}\n\ninput RemoveEmojiReactionInput {\n  messageId: OID! # ID of the message to which the reaction is being removed\n  senderId: ID! # ID of the user that is removing the reaction\n  type: ReactionType! # Type of the reaction (emoji)\n}\n\ninput EditChatNameInput {\n  name: String\n}\n\ninput EditChatDescriptionInput {\n  description: String\n}\n"})}),"\n",(0,a.jsx)(t.h2,{id:"define-the-document-model",children:"Define the document model"}),"\n",(0,a.jsx)(t.p,{children:"To be able to define the document model, you need to open the Chatroom document model editor in Connect."}),"\n",(0,a.jsx)(t.p,{children:"The steps below show you how to do this:"}),"\n",(0,a.jsxs)(t.ol,{children:["\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsxs)(t.p,{children:["In the Connect application, click on the ",(0,a.jsx)(t.code,{children:"ChatRoom"})," document model you've created in the previous step, to open the document model editor."]}),"\n"]}),"\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsx)(t.p,{children:"You'll be welcomed with a form to fill, this is metadata about the document model, fill in the details in the fields."}),"\n",(0,a.jsxs)(t.p,{children:["In the ",(0,a.jsx)(t.code,{children:"Document Type"})," field, type ",(0,a.jsx)(t.code,{children:"powerhouse/chat-room"}),". This defines the new type of document that will be created with this document model."]}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"Chatroom Document Model Form Metadata",src:n(2158).A+"",width:"1902",height:"1738"})}),"\n"]}),"\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsxs)(t.p,{children:["In the code editor, you can see the SDL for the document model. Replace the existing SDL with the SDL defined in the ",(0,a.jsx)(t.a,{href:"#state-schema",children:"State Schema"})," section above. Only copy and paste the types, leaving the inputs for the next step. You can however already press 'Sync with schema' button to set the initial state of your document model based on your Schema Definition Language. Verify that your Global State Initial Value looks like this."]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-json",children:'{\n  "id": "",\n  "name": "",\n  "description": null,\n  "createdAt": null,\n  "createdBy": null,\n  "messages": []\n}\n'})}),"\n",(0,a.jsxs)(t.ol,{start:"4",children:["\n",(0,a.jsxs)(t.li,{children:["Below the editor, there is an input field ",(0,a.jsx)(t.strong,{children:"'Add module'"}),". You need to create and name a module that the input operations will be added to. In this case, we will name the module ",(0,a.jsx)(t.strong,{children:"'general_operations'"}),". Press enter."]}),"\n",(0,a.jsxs)(t.li,{children:["Now there is a new field, called ",(0,a.jsx)(t.strong,{children:"'Add operation'"}),". Here you will have to add each input operation to the module, one by one."]}),"\n",(0,a.jsxs)(t.li,{children:["Inside the ",(0,a.jsx)(t.strong,{children:"'Add operation'"})," field, type ",(0,a.jsx)(t.strong,{children:"'ADD_MESSAGE'"})," and press enter. A small editor will appear under with an empty input type that you have to fill. Copy the first input type from the ",(0,a.jsx)(t.a,{href:"#operations-schema",children:"Operations Schema"})," section and paste it in the editor. The editor should look like this:"]}),"\n"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-graphql",children:"input AddMessageInput {\n  messageId: OID!\n  sender: SenderInput!\n  content: String!\n  sentAt: DateTime!\n}\n\ninput SenderInput {\n  id: ID! # Unique identifier for the sender\n  name: String\n  avatarUrl: URL # Allows us to pull the ENS and/or nft of the persons profile\n}\n"})}),"\n",(0,a.jsxs)(t.ol,{start:"7",children:["\n",(0,a.jsxs)(t.li,{children:["Repeat step 6 for the other input operations based on the ",(0,a.jsx)(t.a,{href:"#operations-schema",children:"Operations Schema"}),". If you noticed, you only need to add the name ",(0,a.jsx)(t.code,{children:"(ADD_EMOJI_REACTION, EDIT_CHAT_NAME, etc)"})," of the operation without the ",(0,a.jsx)(t.code,{children:"input"})," suffix. Then it will be generated once you press enter."]}),"\n",(0,a.jsxs)(t.li,{children:["Let's just add a couple more reducer exceptions to the ",(0,a.jsx)(t.code,{children:"ADD_MESSAGE"})," operation which we'll be using later to avoid empty messages or messages exceeding a maximum lenght. Add ",(0,a.jsx)(t.code,{children:"MessageContentCannotBeEmpty"})," and ",(0,a.jsx)(t.code,{children:"MessageContentExceedsTheMaximumLenght"})," to the reducer exceptions of ",(0,a.jsx)(t.code,{children:"ADD_MESSAGE"})]}),"\n",(0,a.jsxs)(t.li,{children:["Once you have added all the input operations, click on the ",(0,a.jsx)(t.code,{children:"Export"})," button, at the top right of the editor, to save the document model on your local machine. Ideally you already save your file in the root of your powerhouse project on your machine."]}),"\n"]}),"\n",(0,a.jsx)(t.p,{children:"Check the screenshot below to verify the complete implementation:"}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"Chatroom Document Model",src:n(471).A+"",width:"2000",height:"2504"})})]})}function l(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}},2158:(e,t,n)=>{n.d(t,{A:()=>o});const o=n.p+"assets/images/image-2-d698dc1d3b7f6c764415e09f616f6250.png"},7474:(e,t,n)=>{n.d(t,{R:()=>i,x:()=>r});var o=n(2155);const a={},s=o.createContext(a);function i(e){const t=o.useContext(s);return o.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),o.createElement(s.Provider,{value:t},e.children)}}}]);