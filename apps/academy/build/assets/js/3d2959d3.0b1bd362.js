"use strict";(self.webpackChunk_powerhousedao_academy=self.webpackChunk_powerhousedao_academy||[]).push([[5508],{198:(e,i,t)=>{t.d(i,{A:()=>n});const n=t.p+"assets/images/filteroptions-249bfbcbf978ac60883982eac75bda72.png"},362:(e,i,t)=>{t.d(i,{A:()=>n});const n=t.p+"assets/images/filter-6eaaa57fa4783eddc9077f0df182ea13.png"},4551:(e,i,t)=>{t.r(i),t.d(i,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>n,toc:()=>c});const n=JSON.parse('{"id":"academy/MasteryTrack/WorkWithData/Analytics Engine/graphql/index","title":"GraphQL API","description":"A basic understanding of GraphQL is helpful to understand this document, as we use concepts and vocabulary from the broader ecosystem. For a good primer on the subject, see the Introduction to GraphQL.","source":"@site/docs/academy/02-MasteryTrack/04-WorkWithData/06-Analytics Engine/graphql/index.md","sourceDirName":"academy/02-MasteryTrack/04-WorkWithData/06-Analytics Engine/graphql","slug":"/academy/MasteryTrack/WorkWithData/Analytics Engine/graphql/","permalink":"/academy/MasteryTrack/WorkWithData/Analytics Engine/graphql/","draft":false,"unlisted":false,"editUrl":"https://github.com/powerhouse-inc/powerhouse-docs/tree/dev/docs/academy/02-MasteryTrack/04-WorkWithData/06-Analytics Engine/graphql/index.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3},"sidebar":"academySidebar","previous":{"title":"Database schema","permalink":"/academy/MasteryTrack/WorkWithData/Analytics Engine/typescript/schema"},"next":{"title":"Integration","permalink":"/academy/MasteryTrack/WorkWithData/Analytics Engine/graphql/integration"}}');var r=t(5723),s=t(7474);const a={sidebar_position:3},o="GraphQL API",l={},c=[{value:"Basic GraphQL structure",id:"basic-graphql-structure",level:2},{value:"Example",id:"example",level:3},{value:"Analytics query structure",id:"analytics-query-structure",level:2},{value:"Filters",id:"filters",level:3},{value:"Constructing a complete filter object",id:"constructing-a-complete-filter-object",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Common issues",id:"common-issues",level:3},{value:"Error messages",id:"error-messages",level:3}];function d(e){const i={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components},{Details:n}=i;return n||function(e,i){throw new Error("Expected "+(i?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.header,{children:(0,r.jsx)(i.h1,{id:"graphql-api",children:"GraphQL API"})}),"\n",(0,r.jsxs)(i.p,{children:["A basic understanding of GraphQL is helpful to understand this document, as we use concepts and vocabulary from the broader ecosystem. For a good primer on the subject, see the ",(0,r.jsx)(i.a,{href:"https://graphql.org/learn/",children:"Introduction to GraphQL"}),"."]}),"\n",(0,r.jsx)(i.h2,{id:"basic-graphql-structure",children:"Basic GraphQL structure"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsxs)(i.li,{children:["\n",(0,r.jsxs)(i.p,{children:[(0,r.jsx)(i.strong,{children:"Query"}),": At its core, a GraphQL query is about asking or 'querying' for specific fields on objects. The query is structured like a JSON object, but without the values. This structure lets you specify exactly which data you want to fetch from the server."]}),"\n"]}),"\n",(0,r.jsxs)(i.li,{children:["\n",(0,r.jsxs)(i.p,{children:[(0,r.jsx)(i.strong,{children:"Fields"}),": In a GraphQL query, you specify a set of fields within braces. Each field corresponds to a piece of data you want to fetch."]}),"\n"]}),"\n",(0,r.jsxs)(i.li,{children:["\n",(0,r.jsxs)(i.p,{children:[(0,r.jsx)(i.strong,{children:"Nested Fields"}),": Fields can also be nested, allowing you to fetch related data. For example, if you have a user, you can fetch the user's name and, within the same query, fetch a list of the user's friends and their names."]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(i.h3,{id:"example",children:"Example"}),"\n",(0,r.jsx)(i.p,{children:"Imagine you have a user object and you want to fetch the user's name and email, along with the names of their friends. A basic GraphQL query might look like this:"}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-graphql",children:'query {\n  user(id: "1") {\n    name\n    email\n    friends {\n      name\n    }\n  }\n}\n'})}),"\n",(0,r.jsxs)(i.p,{children:["In this example, query is the operation type, user is the field on the root type, and name, email, and friends are fields on the user type. The id: ",(0,r.jsx)(i.code,{children:'"1"'})," is a parameter passed to the query, specifying which user to fetch.\nYou can find more examples of GraphQL core concept in the section ",(0,r.jsx)(i.a,{href:"/academy/MasteryTrack/WorkWithData/GraphQLAtPowerhouse",children:"GraphQL at Powerhouse"}),"."]}),"\n",(0,r.jsx)(i.h2,{id:"analytics-query-structure",children:"Analytics query structure"}),"\n",(0,r.jsx)(i.p,{children:"In the GraphQL query for the Analytics Engine below, each element requests specific pieces of data from the analytics API. Here is a breakdown of the fields and elements with a dropdown with their descriptions below."}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-graphql",children:"query Analytics($filter: AnalyticsFilter) {\n  analytics {\n    series(filter: $filter) {\n      period\n      start\n      end\n      rows {\n        metric\n        unit\n        dimensions {\n          name\n          path\n          label\n          description\n          icon\n        }\n        value\n        sum\n      }\n    }\n  }\n}\n"})}),"\n",(0,r.jsxs)(n,{children:[(0,r.jsx)("summary",{children:"\ud83d\udc49 Expand this dropdown to explore the list of fields and retrievable data.."}),(0,r.jsx)(i.p,{children:"In the provided GraphQL query, each field and element plays a specific role in determining what data is returned by the analytics engine. Here's a clear and concise description of each:"}),(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsxs)(i.li,{children:["\n",(0,r.jsxs)(i.p,{children:[(0,r.jsx)(i.code,{children:"query Analytics($filter: AnalyticsFilter):"})," This is the declaration of the query named 'Analytics', which accepts a variable ",(0,r.jsx)(i.code,{children:"$filter"})," of type ",(0,r.jsx)(i.code,{children:"AnalyticsFilter"}),". This variable will be used to apply certain filters to the analytics data retrieved."]}),"\n"]}),"\n",(0,r.jsxs)(i.li,{children:["\n",(0,r.jsxs)(i.p,{children:[(0,r.jsx)(i.code,{children:"analytics"}),": This is the main query operation. It calls the analytics field on the GraphQL API."]}),"\n"]}),"\n",(0,r.jsxs)(i.li,{children:["\n",(0,r.jsxs)(i.p,{children:[(0,r.jsx)(i.code,{children:"series(filter: $filter)"}),": This field represents a collection of data points or a data set that matches the criteria specified by the filter. It's an array of results, where each result is a time-bound statistical representation of the filtered data. And passes the ",(0,r.jsx)(i.code,{children:"$filter"})," variable as an argument to determine the scope of the data returned."]}),"\n"]}),"\n",(0,r.jsxs)(i.li,{children:["\n",(0,r.jsxs)(i.p,{children:[(0,r.jsx)(i.code,{children:"period"}),": Within each series, this field denotes the aggregation period for the data (e.g., monthly, quarterly, annually). It's a label describing the time span each series covers.\nstart: This is the starting date and time of the data series, indicating when the period begins."]}),"\n"]}),"\n",(0,r.jsxs)(i.li,{children:["\n",(0,r.jsxs)(i.p,{children:[(0,r.jsx)(i.code,{children:"end"}),": This is the ending date and time of the data series, indicating when the period ends."]}),"\n"]}),"\n",(0,r.jsxs)(i.li,{children:["\n",(0,r.jsxs)(i.p,{children:[(0,r.jsx)(i.code,{children:"rows"}),": Represents the individual records or entries in the data series. Each row corresponds to a unique combination of dimensions for the specified period."]}),"\n"]}),"\n",(0,r.jsxs)(i.li,{children:["\n",(0,r.jsxs)(i.p,{children:[(0,r.jsx)(i.code,{children:"metric"}),": Within each row, this field specifies the particular metric being measured (e.g., budget, actuals, forecast)."]}),"\n"]}),"\n",(0,r.jsxs)(i.li,{children:["\n",(0,r.jsxs)(i.p,{children:[(0,r.jsx)(i.code,{children:"unit"}),": This indicates the unit of measurement for the metric, such as quantities, currency (e.g., DAI), or percentages."]}),"\n"]}),"\n",(0,r.jsxs)(i.li,{children:["\n",(0,r.jsxs)(i.p,{children:[(0,r.jsx)(i.code,{children:"dimensions"}),": A nested array that provides context for the metric by breaking it down into finer categories or segments, such as 'project' or 'category'. Each dimension can contain:"]}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.code,{children:"name"}),": The identifier or key for the dimension."]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.code,{children:"path"}),": A structured representation of the dimension's hierarchy or location within a dataset."]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.code,{children:"label"}),": A human-readable label for the dimension, which can be used for display purposes."]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.code,{children:"description"}),": A brief explanation of the dimension to give users an understanding of what it represents."]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.code,{children:"icon"}),": A graphical representation or icon associated with the dimension for easier identification in user interfaces."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(i.li,{children:["\n",(0,r.jsxs)(i.p,{children:[(0,r.jsx)(i.code,{children:"value"}),": The actual numerical value of the metric for each row within the specified period."]}),"\n"]}),"\n",(0,r.jsxs)(i.li,{children:["\n",(0,r.jsxs)(i.p,{children:[(0,r.jsx)(i.code,{children:"sum"}),": A total or aggregated value of the metric over the entire period, providing a summarized figure."]}),"\n"]}),"\n"]}),(0,r.jsx)(i.p,{children:"This query structure allows users to extract detailed and summarized analytics data with it's context provided with the help of the the dimensions, tailored to specific time frames and measurements."})]}),"\n",(0,r.jsx)(i.h3,{id:"filters",children:"Filters"}),"\n",(0,r.jsx)(i.p,{children:"In the analytics engine, the filter object in a GraphQL query is crucial for tailoring the data retrieval to specific requirements. For the query to function correctly, a complete and fully structured filter object, containing all necessary parameters, must be used. Here's a guide on how to construct these filter objects and examples of different filter configurations."}),"\n",(0,r.jsx)(i.h3,{id:"constructing-a-complete-filter-object",children:"Constructing a complete filter object"}),"\n",(0,r.jsx)(i.p,{children:"A filter object must include all the following parameters:"}),"\n",(0,r.jsxs)(i.ol,{children:["\n",(0,r.jsxs)(i.li,{children:["\n",(0,r.jsxs)(i.p,{children:["Start Date (",(0,r.jsx)(i.code,{children:"start"}),"): The beginning date of the data retrieval period."]}),"\n"]}),"\n",(0,r.jsxs)(i.li,{children:["\n",(0,r.jsxs)(i.p,{children:["End Date (",(0,r.jsx)(i.code,{children:"end"}),"): The end date of the data retrieval period."]}),"\n"]}),"\n",(0,r.jsxs)(i.li,{children:["\n",(0,r.jsxs)(i.p,{children:["Granularity(",(0,r.jsx)(i.code,{children:"granularity"}),"): Determines the aggregation level of the data (e.g., total, annual, monthly)."]}),"\n"]}),"\n",(0,r.jsxs)(i.li,{children:["\n",(0,r.jsxs)(i.p,{children:["Metrics (",(0,r.jsx)(i.code,{children:"metrics"}),"): A list of metrics to be analyzed (e.g., Budget, Actuals)."]}),"\n"]}),"\n",(0,r.jsxs)(i.li,{children:["\n",(0,r.jsxs)(i.p,{children:["Dimensions (",(0,r.jsx)(i.code,{children:"dimensions"}),"): Specifies qualitative data categories for segmentation, each with sub-parameters like ",(0,r.jsx)(i.code,{children:"name"}),", ",(0,r.jsx)(i.code,{children:"select"}),", and level of detail (",(0,r.jsx)(i.code,{children:"lod"}),")."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(i.p,{children:["In the analytics engine, dimensions play a critical role in segmenting and analyzing data. The ",(0,r.jsx)(i.code,{children:"select"})," field within a dimension and its correlation with the level of detail (",(0,r.jsx)(i.code,{children:"lod"}),")\nparameter are particularly crucial for tailoring your query to retrieve the most relevant and precise data. Here's a detailed explanation of their importance:"]}),"\n",(0,r.jsxs)(i.p,{children:["The ",(0,r.jsx)(i.code,{children:"select"})," Field in Dimensions - ",(0,r.jsx)(i.strong,{children:"Function"}),': The select field specifies the exact segment or category within a dimension that you want to analyze. For example, in a dimension named "project," the select field could specify a particular project like "SES" or "Atlas." - ',(0,r.jsx)(i.strong,{children:"Path Specification"}),": The value set in the select field often represents a path in the data hierarchy. This path directs the query to focus on specific segments or nodes within the broader dimension category. - ",(0,r.jsx)(i.strong,{children:"Precision in Data Retrieval"}),": By setting the right path in the select field, you ensure that the query fetches data pertinent only to that specific segment, leading to more targeted and relevant insights. - ",(0,r.jsx)(i.strong,{children:"Example"}),": If you set the ",(0,r.jsx)(i.strong,{children:"select"}),' field to "',(0,r.jsx)(i.code,{children:"atlas/scopes/SUP/I/PHOENIX/"}),'" in the "',(0,r.jsx)(i.code,{children:"budget"}),'" dimension, the query will retrieve data related to the budget allocated specifically for the "',(0,r.jsx)(i.code,{children:"PHOENIX"}),'" project under the "',(0,r.jsx)(i.code,{children:"SUP"}),'" scope in the "',(0,r.jsx)(i.code,{children:"Atlas"}),'" system.']}),"\n",(0,r.jsxs)(i.p,{children:["The level of detail (",(0,r.jsx)(i.code,{children:"lod"}),") Parameter - ",(0,r.jsx)(i.strong,{children:"Granularity"})," Within Dimensions: While the select field specifies what to select within a dimension, the ",(0,r.jsx)(i.code,{children:"lod"})," parameter determines how detailed or summarized the information should be. - ",(0,r.jsx)(i.strong,{children:"Hierarchy Levels"}),": Different levels in ",(0,r.jsx)(i.code,{children:"lod"})," represent different levels of detail in the data hierarchy. A higher ",(0,r.jsx)(i.code,{children:"lod"})," value typically means a more detailed breakdown, while a lower value indicates a more summarized or aggregated view. - ",(0,r.jsxs)(i.strong,{children:["Correlation with ",(0,r.jsx)(i.code,{children:"select"})," Path"]}),": The lod value you choose should correspond appropriately to the path specified in the ",(0,r.jsx)(i.code,{children:"select"})," field. A mismatch might lead to data that is either too granular or too generalized than what is needed. - ",(0,r.jsx)(i.strong,{children:"Impact on Analysis"}),": The level of detail can significantly affect the analysis. For instance, a high lod can provide in-depth insights into a specific area, useful for detailed audits or close examination of a particular segment. Conversely, a low lod is better for broader overviews or when comparing larger categories."]}),"\n",(0,r.jsxs)(i.p,{children:["Importance of Correct Configuration - ",(0,r.jsx)(i.strong,{children:"Accuracy of Results"}),": Setting the correct path in the select field and aligning it with an appropriate lod ensures the accuracy and relevance of the query results. Incorrect or mismatched configurations might lead to misleading insights or data that doesn't serve the intended analytical purpose. - ",(0,r.jsx)(i.strong,{children:"Customized Analysis"}),": Together, the select field and lod allow for a high degree of customization in data queries. Users can tailor their data requests precisely to their specific requirements, whether they need a broad overview or a detailed breakdown. - Follow the right upper or lower case letter style from metrics, granularity and dimensions."]}),"\n",(0,r.jsxs)(i.ol,{start:"6",children:["\n",(0,r.jsxs)(i.li,{children:[(0,r.jsxs)(i.strong,{children:["Currency (",(0,r.jsx)(i.code,{children:"currency"}),")"]}),": The currency format for the financial data (e.g., DAI, MKR)."]}),"\n"]}),"\n",(0,r.jsx)(i.p,{children:"The filter object can be created by using the UI menu from the graphql apollo studio explorer:"}),"\n",(0,r.jsxs)(i.p,{children:[(0,r.jsx)(i.img,{alt:"untitled",src:t(362).A+"",width:"636",height:"439"}),"\n",(0,r.jsx)(i.em,{children:"Select the filter"})]}),"\n",(0,r.jsxs)(i.p,{children:[(0,r.jsx)(i.img,{alt:"untitled",src:t(198).A+"",width:"604",height:"466"}),"\n",(0,r.jsx)(i.em,{children:"Select all filter fields and sub fields"})]}),"\n",(0,r.jsx)(i.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,r.jsx)(i.h3,{id:"common-issues",children:"Common issues"}),"\n",(0,r.jsxs)(i.p,{children:[(0,r.jsx)(i.strong,{children:"Mistyping the filter options or not using proper upper or lower case when necessary."})," Make sure to check this first when running into problems"]}),"\n",(0,r.jsx)(i.h3,{id:"error-messages",children:"Error messages"}),"\n",(0,r.jsx)(i.p,{children:"Usually, error messages are explicit and easy to understand what is wrong, below you can find some examples."}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsxs)(i.li,{children:["\n",(0,r.jsxs)(i.p,{children:[(0,r.jsx)(i.code,{children:'"message": "Cannot read properties of undefined (reading \'filter\')"'}),", \u2192 There is something wrong with the filter options, make sure you've added all fields in the filter options."]}),"\n"]}),"\n",(0,r.jsxs)(i.li,{children:["\n",(0,r.jsxs)(i.p,{children:[(0,r.jsx)(i.code,{children:'"message": "No valid metrics provided, make sure to use metrics from this list: Actuals, Budget, Forecast, FTEs, PaymentsOffChainIncluded, PaymentsOnChain, ProtocolNetOutflow"'}),", \u2192 A wrong format when adding metrics"]}),"\n"]}),"\n",(0,r.jsxs)(i.li,{children:["\n",(0,r.jsxs)(i.p,{children:[(0,r.jsx)(i.code,{children:'"message": "Variable \\"$filter\\" got invalid value \\"Monthlyu\\" at \\"filter.granularity\\"; Value \\"Monthlyu\\" does not exist in \\"AnalyticsGranularity\\" enum. Did you mean the enum value \\"monthly\\"?"'}),", \u2192 Granularity filter is mistyped."]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(i.p,{children:(0,r.jsx)(i.strong,{children:"If you are receiving error messages with status code of 500, reach out to the dev team."})})]})}function h(e={}){const{wrapper:i}={...(0,s.R)(),...e.components};return i?(0,r.jsx)(i,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},7474:(e,i,t)=>{t.d(i,{R:()=>a,x:()=>o});var n=t(2155);const r={},s=n.createContext(r);function a(e){const i=n.useContext(s);return n.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function o(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),n.createElement(s.Provider,{value:i},e.children)}}}]);