"use strict";(self.webpackChunk_powerhousedao_academy=self.webpackChunk_powerhousedao_academy||[]).push([[4468],{481:(e,t,o)=>{o.r(t),o.d(t,{assets:()=>c,contentTitle:()=>r,default:()=>m,frontMatter:()=>i,metadata:()=>n,toc:()=>a});const n=JSON.parse('{"id":"academy/TodoListTutorial/AddSharedComponentForShowingTodoListStats","title":"Step 7 - Add shared component for showing TodoList stats","description":"So far we\'ve been creating components that live in the same directories as the editors that use them. But sometimes we want to use the same component across multiple editors.","source":"@site/docs/academy/10-TodoListTutorial/07-AddSharedComponentForShowingTodoListStats.md","sourceDirName":"academy/10-TodoListTutorial","slug":"/academy/TodoListTutorial/AddSharedComponentForShowingTodoListStats","permalink":"/academy/TodoListTutorial/AddSharedComponentForShowingTodoListStats","draft":false,"unlisted":false,"editUrl":"https://github.com/powerhouse-inc/powerhouse-docs/tree/dev/docs/academy/10-TodoListTutorial/07-AddSharedComponentForShowingTodoListStats.md","tags":[],"version":"current","sidebarPosition":7,"frontMatter":{}}');var s=o(5723),d=o(7474);const i={},r="Step 7 - Add shared component for showing TodoList stats",c={},a=[{value:"Creating the <code>&lt;Stats /&gt;</code> component",id:"creating-the-stats--component",level:2},{value:"Using the  <code>&lt;Stats /&gt;</code> component in our <code>TodoListEditor</code>",id:"using-the--stats--component-in-our-todolisteditor",level:2},{value:"Using the <code>&lt;Stats /&gt;</code> component in our <code>TodoDriveExplorer</code>",id:"using-the-stats--component-in-our-tododriveexplorer",level:2},{value:"Check your work",id:"check-your-work",level:2},{value:"The end",id:"the-end",level:2}];function l(e){const t={code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,d.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"step-7---add-shared-component-for-showing-todolist-stats",children:"Step 7 - Add shared component for showing TodoList stats"})}),"\n",(0,s.jsx)(t.p,{children:"So far we've been creating components that live in the same directories as the editors that use them. But sometimes we want to use the same component across multiple editors."}),"\n",(0,s.jsx)(t.p,{children:"Let's create a component for showing statistics about our todos. We'd like this component to work with any set of todos or todo lists, so that we can use the same one in our document editor or in our drive editor or a folder."}),"\n",(0,s.jsxs)(t.h2,{id:"creating-the-stats--component",children:["Creating the ",(0,s.jsx)(t.code,{children:"<Stats />"})," component"]}),"\n",(0,s.jsxs)(t.p,{children:["Create a new directory at ",(0,s.jsx)(t.code,{children:"editors/components"})," and create two new files inside it:"]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.code,{children:"editors/components/Stats.tsx"})," with this content:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-jsx",children:'import type {\n  TodoItem,\n  TodoListDocument,\n} from "todo-tutorial/document-models/todo-list";\n\ntype Props = {\n  todos: TodoItem[] | undefined;\n  todoListDocuments?: TodoListDocument[] | undefined;\n  createdAtUtcIso?: string;\n  lastModifiedAtUtcIso?: string;\n};\n\n/** Generic component for showing statistics about todo lists and the todos they contain */\nexport function Stats({\n  todos,\n  todoListDocuments,\n  createdAtUtcIso,\n  lastModifiedAtUtcIso,\n}: Props) {\n  const totalTodos = todos?.length ?? 0;\n  const totalChecked = todos?.filter((todo) => todo.checked).length ?? 0;\n  const totalUnchecked = todos?.filter((todo) => !todo.checked).length ?? 0;\n  const percentageChecked = Math.round(\n    calculatePercentage(totalTodos, totalChecked),\n  );\n  const percentageUnchecked = Math.round(\n    calculatePercentage(totalTodos, totalUnchecked),\n  );\n  const createdAt = createdAtUtcIso ? new Date(createdAtUtcIso) : null;\n  const hasCreatedAt = createdAt !== null;\n  const lastModified = lastModifiedAtUtcIso\n    ? new Date(lastModifiedAtUtcIso)\n    : null;\n  const hasLastModified = lastModified !== null;\n  const createdAtFormattedDate = createdAt\n    ? createdAt.toLocaleDateString()\n    : null;\n  const lastModifiedFormattedDate = lastModified\n    ? lastModified.toLocaleDateString()\n    : null;\n  const createdAtFormattedTime = createdAt\n    ? createdAt.toLocaleTimeString()\n    : null;\n  const lastModifiedFormattedTime = lastModified\n    ? lastModified.toLocaleTimeString()\n    : null;\n  const totalTodoListDocuments = todoListDocuments?.length ?? 0;\n  const hasTodoLists = todoListDocuments !== undefined;\n\n  return (\n    <ul className="text-sm text-gray-800 max-w-1/2">\n      {hasTodoLists && (\n        <li className="flex justify-between">\n          <span>Todo Lists:</span> <span>{totalTodoListDocuments}</span>\n        </li>\n      )}\n      <li className="flex justify-between">\n        <span>Todos:</span> <span>{totalTodos}</span>\n      </li>\n      <li className="flex justify-between">\n        <span>Checked:</span>{" "}\n        <span>\n          {totalChecked} ({percentageChecked}%)\n        </span>\n      </li>\n      <li className="flex justify-between">\n        <span>Unchecked:</span>{" "}\n        <span>\n          {totalUnchecked} ({percentageUnchecked}%)\n        </span>\n      </li>\n      {hasCreatedAt && (\n        <li className="flex justify-between">\n          <span>Created:</span>{" "}\n          <span>\n            {createdAtFormattedDate} {createdAtFormattedTime}\n          </span>\n        </li>\n      )}\n      {hasLastModified && (\n        <li className="flex justify-between">\n          <span>Last modified:</span>{" "}\n          <span>\n            {lastModifiedFormattedDate} {lastModifiedFormattedTime}\n          </span>\n        </li>\n      )}\n    </ul>\n  );\n}\n\nfunction calculatePercentage(total: unknown, value: unknown) {\n  if (typeof total !== "number" || typeof value !== "number") {\n    return 0;\n  }\n  const ratio = value / total;\n  if (isNaN(ratio)) {\n    return 0;\n  }\n  return ratio * 100;\n}\n'})}),"\n",(0,s.jsxs)(t.p,{children:["And ",(0,s.jsx)(t.code,{children:"editors/components/index.ts"})," with this content:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-ts",children:'export { Stats } from "./Stats.js";\n'})}),"\n",(0,s.jsxs)(t.p,{children:["The index file lets us use a nice neat import path like ",(0,s.jsx)(t.code,{children:"todo-tutorial/editors/components"})," in all of our editor components."]}),"\n",(0,s.jsx)(t.p,{children:"Don't be too concerned with the math and time related code you see here \u2014 those are just implementation details."}),"\n",(0,s.jsxs)(t.h2,{id:"using-the--stats--component-in-our-todolisteditor",children:["Using the  ",(0,s.jsx)(t.code,{children:"<Stats />"})," component in our ",(0,s.jsx)(t.code,{children:"TodoListEditor"})]}),"\n",(0,s.jsxs)(t.p,{children:["Now let's use the ",(0,s.jsx)(t.code,{children:"<Stats />"})," component in our ",(0,s.jsx)(t.code,{children:"<TodoList />"})," component:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-diff",children:'import { useSelectedTodoListDocument } from "todo-tutorial/document-models/todo-list";\n+ import { Stats } from "todo-tutorial/editors/components";\nimport { EditTodoListName } from "./EditName.js";\nimport { Todos } from "./Todos.js";\nimport { AddTodo } from "./AddTodo.js";\nimport { CloseButton } from "./CloseButton.js";\n\n/** Displays the selected todo list */\nexport function TodoList() {\n  const [selectedTodoList] = useSelectedTodoListDocument();\n\n  if (!selectedTodoList) return null;\n\n  const todos = selectedTodoList.state.global.items;\n+ const createdAtUtcIso = selectedTodoList.header.createdAtUtcIso;\n+ const lastModifiedAtUtcIso = selectedTodoList.header.lastModifiedAtUtcIso;\n\n  return (\n    <div>\n      <section className="mb-4 flex gap-2 items-center">\n        <div className="grow">\n          <EditTodoListName />\n        </div>\n        <div className="flex-none">\n          <CloseButton />\n        </div>\n      </section>\n+     <section className="mb-4">\n+       <Stats\n+         todos={todos}\n+         createdAtUtcIso={createdAtUtcIso}\n+         lastModifiedAtUtcIso={lastModifiedAtUtcIso}\n+       />\n+     </section>\n      <section className="mb-4">\n        <Todos todos={todos} />\n      </section>\n      <section>\n        <AddTodo />\n      </section>\n    </div>\n  );\n}\n'})}),"\n",(0,s.jsx)(t.p,{children:"With this, you will now see statistics about the todo items in a todo list document."}),"\n",(0,s.jsxs)(t.p,{children:["And now we can also show off the flexibility of our new ",(0,s.jsx)(t.code,{children:"<Stats />"})," component. Since drives are also just documents themselves, we can derive the same information about a drive too. This means we can use this same component in our drive editor as well."]}),"\n",(0,s.jsxs)(t.h2,{id:"using-the-stats--component-in-our-tododriveexplorer",children:["Using the ",(0,s.jsx)(t.code,{children:"<Stats />"})," component in our ",(0,s.jsx)(t.code,{children:"TodoDriveExplorer"})]}),"\n",(0,s.jsxs)(t.p,{children:["Let's add this to our ",(0,s.jsx)(t.code,{children:"<DriveContents />"})," component, along with some conditional logic that either shows stats for the selected folder (if one is selected) or the selected drive otherwise."]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-diff",children:'+ import {\n+   useSelectedDrive,\n+   useSelectedFolder,\n+ } from "@powerhousedao/reactor-browser";\nimport { CreateDocument } from "./CreateDocument.js";\nimport { EmptyState } from "./EmptyState.js";\nimport { Files } from "./Files.js";\nimport { Folders } from "./Folders.js";\nimport { NavigationBreadcrumbs } from "./NavigationBreadcrumbs.js";\n+ import { Stats } from "todo-tutorial/editors/components";\n+ import {\n+   useTodoListDocumentsInSelectedDrive,\n+   useTodoListDocumentsInSelectedFolder,\n+   type TodoItem,\n+   type TodoListDocument,\n+ } from "todo-tutorial/document-models/todo-list";\n\n+ /** Small helper function to get all todo items from all todo lists */\n+ export function getAllTodoItemsFromTodoLists(\n+   todoLists: TodoListDocument[] | undefined,\n+ ): TodoItem[] {\n+   return todoLists?.flatMap((todoList) => todoList.state.global.items) ?? [];\n+ }\n\n/** Shows the documents and folders in the selected drive */\nexport function DriveContents() {\n+ const selectedFolder = useSelectedFolder();\n+ const hasSelectedFolder = selectedFolder !== undefined;\n  return (\n    <div className="space-y-6 px-6">\n      <NavigationBreadcrumbs />\n+     {hasSelectedFolder ? <FolderStats /> : <DriveStats />}\n      <Folders />\n      <Files />\n      <EmptyState />\n      <CreateDocument />\n    </div>\n  );\n}\n\n+ /** Shows the statistics for the selected drive */\n+ function DriveStats() {\n+   const todoListDocumentsInSelectedDrive =\n+     useTodoListDocumentsInSelectedDrive();\n+   const allTodos = getAllTodoItemsFromTodoLists(\n+     todoListDocumentsInSelectedDrive,\n+   );\n+   const [selectedDrive] = useSelectedDrive();\n+   const driveCreatedAt = selectedDrive.header.createdAtUtcIso;\n+   const driveLastModified = selectedDrive.header.lastModifiedAtUtcIso;\n+ \n+   return (\n+     <Stats\n+       todos={allTodos}\n+       todoListDocuments={todoListDocumentsInSelectedDrive}\n+       createdAtUtcIso={driveCreatedAt}\n+       lastModifiedAtUtcIso={driveLastModified}\n+     />\n+   );\n+ }\n+ \n+ /** Shows the statistics for the selected folder */\n+ function FolderStats() {\n+   const todoListDocumentsInSelectedFolder =\n+     useTodoListDocumentsInSelectedFolder();\n+   const allTodos = getAllTodoItemsFromTodoLists(\n+     todoListDocumentsInSelectedFolder,\n+   );\n+ \n+   return (\n+     <Stats\n+       todos={allTodos}\n+       todoListDocuments={todoListDocumentsInSelectedFolder}\n+     />\n+   );\n+ }\n'})}),"\n",(0,s.jsx)(t.p,{children:"The final result should look like this:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-jsx",children:'import {\n  useSelectedDrive,\n  useSelectedFolder,\n} from "@powerhousedao/reactor-browser";\nimport { CreateDocument } from "./CreateDocument.js";\nimport { EmptyState } from "./EmptyState.js";\nimport { Files } from "./Files.js";\nimport { Folders } from "./Folders.js";\nimport { NavigationBreadcrumbs } from "./NavigationBreadcrumbs.js";\nimport { Stats } from "todo-tutorial/editors/components";\nimport {\n  useTodoListDocumentsInSelectedDrive,\n  useTodoListDocumentsInSelectedFolder,\n  type TodoItem,\n  type TodoListDocument,\n} from "todo-tutorial/document-models/todo-list";\n\n/** Small helper function to get all todo items from all todo lists */\nexport function getAllTodoItemsFromTodoLists(\n  todoLists: TodoListDocument[] | undefined,\n): TodoItem[] {\n  return todoLists?.flatMap((todoList) => todoList.state.global.items) ?? [];\n}\n\n/** Shows the documents and folders in the selected drive */\nexport function DriveContents() {\n  const selectedFolder = useSelectedFolder();\n  const hasSelectedFolder = selectedFolder !== undefined;\n  return (\n    <div className="space-y-6 px-6">\n      <NavigationBreadcrumbs />\n      {hasSelectedFolder ? <FolderStats /> : <DriveStats />}\n      <Folders />\n      <Files />\n      <EmptyState />\n      <CreateDocument />\n    </div>\n  );\n}\n\n/** Shows the statistics for the selected drive */\nfunction DriveStats() {\n  const todoListDocumentsInSelectedDrive =\n    useTodoListDocumentsInSelectedDrive();\n  const allTodos = getAllTodoItemsFromTodoLists(\n    todoListDocumentsInSelectedDrive,\n  );\n  const [selectedDrive] = useSelectedDrive();\n  const driveCreatedAt = selectedDrive.header.createdAtUtcIso;\n  const driveLastModified = selectedDrive.header.lastModifiedAtUtcIso;\n\n  return (\n    <Stats\n      todos={allTodos}\n      todoListDocuments={todoListDocumentsInSelectedDrive}\n      createdAtUtcIso={driveCreatedAt}\n      lastModifiedAtUtcIso={driveLastModified}\n    />\n  );\n}\n\n/** Shows the statistics for the selected folder */\nfunction FolderStats() {\n  const todoListDocumentsInSelectedFolder =\n    useTodoListDocumentsInSelectedFolder();\n  const allTodos = getAllTodoItemsFromTodoLists(\n    todoListDocumentsInSelectedFolder,\n  );\n\n  return (\n    <Stats\n      todos={allTodos}\n      todoListDocuments={todoListDocumentsInSelectedFolder}\n    />\n  );\n}\n'})}),"\n",(0,s.jsx)(t.p,{children:"With this update, you can now see the statistics for the todo lists and todo items for the selected drive, folder or document depending on which you select."}),"\n",(0,s.jsx)(t.h2,{id:"check-your-work",children:"Check your work"}),"\n",(0,s.jsx)(t.p,{children:"To make sure all works as expected, we should:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["check types\nrun: ",(0,s.jsx)(t.code,{children:"pnpm tsc"})]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["check linting\nrun: ",(0,s.jsx)(t.code,{children:"pnpm lint"})]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["check tests\nrun: ",(0,s.jsx)(t.code,{children:"pnpm test"})]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["test in connect\nrun: ",(0,s.jsx)(t.code,{children:"pnpm connect"})," \u2014 you should now be able to see the ",(0,s.jsx)(t.code,{children:"<Stats />"})," component showing the data for your drives, folder and documents."]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["make sure your code matches the code in the completed step branch\nrun: ",(0,s.jsx)(t.code,{children:"git diff step-7-complete-added-shared-component-for-showing-todo-list-stats"})]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"the-end",children:"The end"}),"\n",(0,s.jsxs)(t.p,{children:["Congratulations! You now have a working ",(0,s.jsx)(t.code,{children:"TodoList"})," document model, and editor for those documents, and a drive editor for managing those documents. This will make a good starting point for creating your own new implementations."]}),"\n",(0,s.jsx)(t.p,{children:"We're excited to see what you build!"})]})}function m(e={}){const{wrapper:t}={...(0,d.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},7474:(e,t,o)=>{o.d(t,{R:()=>i,x:()=>r});var n=o(2155);const s={},d=n.createContext(s);function i(e){const t=n.useContext(d);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),n.createElement(d.Provider,{value:t},e.children)}}}]);