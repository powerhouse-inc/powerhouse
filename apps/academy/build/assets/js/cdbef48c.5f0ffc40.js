"use strict";(self.webpackChunk_powerhousedao_academy=self.webpackChunk_powerhousedao_academy||[]).push([[5740],{5537:(e,o,t)=>{t.r(o),t.d(o,{assets:()=>c,contentTitle:()=>r,default:()=>m,frontMatter:()=>i,metadata:()=>n,toc:()=>l});const n=JSON.parse('{"id":"academy/TodoListTutorial/ImplementTodoListDocumentEditorUIComponents","title":"Step 5 \u2014 Implement TodoList document editor UI components","description":"Out of the box, we have a component for updating our TodoList documents\' names, but we would like to create, read, update, and delete all of the data in our documents.","source":"@site/docs/academy/10-TodoListTutorial/05-ImplementTodoListDocumentEditorUIComponents.md","sourceDirName":"academy/10-TodoListTutorial","slug":"/academy/TodoListTutorial/ImplementTodoListDocumentEditorUIComponents","permalink":"/academy/TodoListTutorial/ImplementTodoListDocumentEditorUIComponents","draft":false,"unlisted":false,"editUrl":"https://github.com/powerhouse-inc/powerhouse-docs/tree/dev/docs/academy/10-TodoListTutorial/05-ImplementTodoListDocumentEditorUIComponents.md","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{}}');var d=t(5723),s=t(7474);const i={},r="Step 5 \u2014 Implement TodoList document editor UI components",c={},l=[{value:"Add a component for showing our todo list in the document editor",id:"add-a-component-for-showing-our-todo-list-in-the-document-editor",level:2},{value:"Add a component for adding todo items to a todo list",id:"add-a-component-for-adding-todo-items-to-a-todo-list",level:2},{value:"Add a button for closing the open <code>TodoList</code> document",id:"add-a-button-for-closing-the-open-todolist-document",level:2},{value:"Add components for todo items and the list of todo items",id:"add-components-for-todo-items-and-the-list-of-todo-items",level:2},{value:"Check your work",id:"check-your-work",level:2},{value:"Up next: generating a custom drive explorer for managing our <code>TodoList</code> documents",id:"up-next-generating-a-custom-drive-explorer-for-managing-our-todolist-documents",level:2}];function a(e){const o={code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components},{CloseButton:t,EditTodoListName:n,TodoList:i}=o;return t||u("CloseButton",!0),n||u("EditTodoListName",!0),i||u("TodoList",!0),(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(o.header,{children:(0,d.jsxs)(o.h1,{id:"step-5--implement-todolist-document-editor-ui-components",children:["Step 5 \u2014 Implement ",(0,d.jsx)(o.code,{children:"TodoList"})," document editor UI components"]})}),"\n",(0,d.jsxs)(o.p,{children:["Out of the box, we have a component for updating our ",(0,d.jsx)(o.code,{children:"TodoList"})," documents' names, but we would like to create, read, update, and delete all of the data in our documents."]}),"\n",(0,d.jsx)(o.h2,{id:"add-a-component-for-showing-our-todo-list-in-the-document-editor",children:"Add a component for showing our todo list in the document editor"}),"\n",(0,d.jsxs)(o.p,{children:["Let's start by adding a ",(0,d.jsx)(i,{})," component that will be the main container we show when you open a TodoList document."]}),"\n",(0,d.jsxs)(o.p,{children:["Create a new file at ",(0,d.jsx)(o.code,{children:"editors/todo-list-editor/components/TodoList.tsx"})," and add this:"]}),"\n",(0,d.jsx)(o.pre,{children:(0,d.jsx)(o.code,{className:"language-jsx",children:'import { useSelectedTodoListDocument } from "todo-tutorial/document-models/todo-list";\nimport { EditTodoListName } from "./EditName.js";\n\n/** Displays the selected todo list */\nexport function TodoList() {\n  // this hook returns the currently selected TodoList document\n  const [selectedTodoList] = useSelectedTodoListDocument();\n\n  if (!selectedTodoList) return null;\n\n  return (\n    <div>\n     <EditTodoListName />\n      <pre>\n       {JSON.stringify(selectedTodoListDocument)}\n      </pre>\n    </div>\n  );\n}\n'})}),"\n",(0,d.jsxs)(o.p,{children:["We've moved the ",(0,d.jsx)(n,{})," component here, so replace it in ",(0,d.jsx)(o.code,{children:"editors/todo-list-editor/editor.tsx"})," with this component we just created."]}),"\n",(0,d.jsx)(o.pre,{children:(0,d.jsx)(o.code,{className:"language-diff",children:'- import { EditTodoListName } from "./components/EditName.js";\n+ import { TodoList } from "./components/TodoList.js";\n\nexport default function Editor() {\n  return (\n    <div className="py-4 px-8">\n-      <EditTodoListName />\n+      <TodoList />\n    </div>\n  );\n}\n'})}),"\n",(0,d.jsx)(o.p,{children:"Now when you open a TodoList document in Connect, you will see an (albeit ugly for now) representation of your whole document in JSON."}),"\n",(0,d.jsx)(o.h2,{id:"add-a-component-for-adding-todo-items-to-a-todo-list",children:"Add a component for adding todo items to a todo list"}),"\n",(0,d.jsx)(o.p,{children:"Next, let's add a component for adding todos to a todo list."}),"\n",(0,d.jsxs)(o.p,{children:["Create a new file at ",(0,d.jsx)(o.code,{children:"editors/todo-list-editor/components/AddTodo.tsx"})," and add this to it:"]}),"\n",(0,d.jsx)(o.pre,{children:(0,d.jsx)(o.code,{className:"language-jsx",children:'import type { FormEventHandler } from "react";\nimport { addTodoItem } from "todo-tutorial/document-models/todo-list";\nimport { useSelectedTodoListDocument } from "todo-tutorial/document-models/todo-list";\n\nexport function AddTodo() {\n  // The hooks for getting documents also return a dispatch function for dispatching actions to modify the document.\n\n  // This is the same pattern you will have seen in React\'s `useReducer` hook, except you don\'t need to pass the initial state.\n\n  // The document we are working with _is_ the initial state.\n  const [todoList, dispatch] = useSelectedTodoListDocument();\n\n  if (!todoList) return null;\n\n  const onSubmitAddTodo: FormEventHandler<HTMLFormElement> = (event) => {\n    event.preventDefault();\n\n    const form = event.currentTarget;\n    const addTodoInput = form.elements.namedItem("addTodo") as HTMLInputElement;\n    const text = addTodoInput.value;\n    if (!text) return;\n\n    dispatch(addTodoItem({ text }));\n\n    form.reset();\n  };\n\n  return (\n    <form onSubmit={onSubmitAddTodo} className="flex mx-auto min-w-fit gap-2">\n      <input\n        className="py-1 px-2 grow min-w-fit placeholder:text-gray-600 rounded border border-gray-600 text-gray-800"\n        type="text"\n        name="addTodo"\n        placeholder="What needs to be done?"\n        autoFocus\n      />\n      <button\n        type="submit"\n        className="text-gray-600 rounded border border-gray-600 px-3 py-1"\n      >\n        Add\n      </button>\n    </form>\n  );\n}\n'})}),"\n",(0,d.jsx)(o.p,{children:"We have provided some basic Tailwind styles but you are welcome to style your components however you wish. This hooks and functions also work with other component libraries like Radix etc."}),"\n",(0,d.jsxs)(o.p,{children:["Let's add this component to our ",(0,d.jsx)(i,{})," component."]}),"\n",(0,d.jsx)(o.pre,{children:(0,d.jsx)(o.code,{className:"language-diff",children:'import { useSelectedTodoListDocument } from "todo-tutorial/document-models/todo-list";\nimport { EditTodoListName } from "./EditName.js";\n+ import { AddTodo } from "./AddTodo.js";\n\n/** Displays the selected todo list */\nexport function TodoList() {\n  // this hook returns the currently selected TodoList document\n  const [selectedTodoList] = useSelectedTodoListDocument();\n\n  if (!selectedTodoList) return null;\n\n  return (\n    <div>\n     <EditTodoListName />\n+    <AddTodo />\n      <pre>\n       {JSON.stringify(selectedTodoListDocument)}\n      </pre>\n    </div>\n  );\n}\n'})}),"\n",(0,d.jsx)(o.p,{children:"Now when you open a TodoList document in Connect, you can add more todos."}),"\n",(0,d.jsxs)(o.h2,{id:"add-a-button-for-closing-the-open-todolist-document",children:["Add a button for closing the open ",(0,d.jsx)(o.code,{children:"TodoList"})," document"]}),"\n",(0,d.jsx)(o.p,{children:"Of course it's all well and good to be able to open TodoList documents, but we would also like to be able to close them."}),"\n",(0,d.jsxs)(o.p,{children:["Let's add a ",(0,d.jsx)(t,{})," component that closes the selected document when clicked."]}),"\n",(0,d.jsxs)(o.p,{children:["Create a new file at ",(0,d.jsx)(o.code,{children:"editors/todo-list-editor/components/CloseButton.tsx"})," and add this content:"]}),"\n",(0,d.jsx)(o.pre,{children:(0,d.jsx)(o.code,{className:"language-jsx",children:'import { setSelectedNode } from "@powerhousedao/reactor-browser";\nimport type { MouseEventHandler } from "react";\n\n/** Closes the selected todo list document editor */\nexport function CloseButton() {\n  const onCloseButtonClick: MouseEventHandler<HTMLButtonElement> = () => {\n    // this function sets the selected node in Connect.\n    // a node can be either a file or a folder, and the same function works for both.\n    // notably, this is not a hook and therefore does not need to abide by the rules of hooks.\n    setSelectedNode(undefined);\n  };\n\n  return (\n    <button onClick={onCloseButtonClick} className="text-sm text-gray-600">\n      Close\n    </button>\n  );\n}\n'})}),"\n",(0,d.jsxs)(o.p,{children:["Let's add this component to our ",(0,d.jsx)(i,{})," component:"]}),"\n",(0,d.jsx)(o.pre,{children:(0,d.jsx)(o.code,{className:"language-diff",children:'import { useSelectedTodoListDocument } from "todo-tutorial/document-models/todo-list";\nimport { EditTodoListName } from "./EditName.js";\nimport { AddTodo } from "./AddTodo.js";\n+ import { CloseButton } from "./CloseButton.js";\n\n/** Displays the selected todo list */\nexport function TodoList() {\n  // this hook returns the currently selected TodoList document\n  const [selectedTodoList] = useSelectedTodoListDocument();\n\n  if (!selectedTodoList) return null;\n\n  return (\n    <div>\n     <EditTodoListName />\n+    <CloseButton />\n     <AddTodo />\n      <pre>\n       {JSON.stringify(selectedTodoListDocument)}\n      </pre>\n    </div>\n  );\n}\n'})}),"\n",(0,d.jsx)(o.p,{children:"Now you have a button you can click to close the selected document."}),"\n",(0,d.jsx)(o.h2,{id:"add-components-for-todo-items-and-the-list-of-todo-items",children:"Add components for todo items and the list of todo items"}),"\n",(0,d.jsx)(o.p,{children:"Finally, let's add a component for showing and editing and individual todo item in a todo list, and another one for showing the list of todo items."}),"\n",(0,d.jsxs)(o.p,{children:["Create a new file at ",(0,d.jsx)(o.code,{children:"editors/todo-list-editor/components/Todo.tsx"})," and add this content:"]}),"\n",(0,d.jsx)(o.pre,{children:(0,d.jsx)(o.code,{className:"language-jsx",children:'import {\n  useState,\n  type ChangeEventHandler,\n  type FormEventHandler,\n  type MouseEventHandler,\n} from "react";\nimport {\n  deleteTodoItem,\n  updateTodoItem,\n} from "todo-tutorial/document-models/todo-list";\nimport type { TodoItem } from "todo-tutorial/document-models/todo-list";\nimport { useSelectedTodoListDocument } from "todo-tutorial/document-models/todo-list";\n\ntype Props = {\n  todo: TodoItem;\n};\n/** Displays a single todo item in the selected todo list\n *\n * Allows checking/unchecking the todo item.\n * Allows editing the todo item text.\n * Allows deleting the todo item.\n */\nexport function Todo({ todo }: Props) {\n  const [isEditing, setIsEditing] = useState(false);\n  // even though this component is for a todo item and not a whole list, we can use the exact same hook for dispatching updates to it.\n  const [todoList, dispatch] = useSelectedTodoListDocument();\n\n  if (!todoList) return null;\n\n  const todoId = todo.id;\n  const todoText = todo.text;\n  const todoChecked = todo.checked;\n\n  const onSubmitUpdateTodoText: FormEventHandler<HTMLFormElement> = (event) => {\n    event.preventDefault();\n\n    const form = event.currentTarget;\n    const textInput = form.elements.namedItem("todoText") as HTMLInputElement;\n    const text = textInput.value;\n    if (!text) return;\n    // we can use this dispatch function for any of the actions supported by a TodoList document\n    dispatch(updateTodoItem({ id: todo.id, text }));\n    setIsEditing(false);\n  };\n\n  const onChangeTodoChecked: ChangeEventHandler<HTMLInputElement> = (event) => {\n    dispatch(\n      updateTodoItem({\n        id: todo.id,\n        checked: event.target.checked,\n      }),\n    );\n  };\n\n  const onClickDeleteTodo: MouseEventHandler<HTMLButtonElement> = () => {\n    dispatch(deleteTodoItem({ id: todoId }));\n  };\n\n  const onClickEditTodo: MouseEventHandler<HTMLButtonElement> = () => {\n    setIsEditing(true);\n  };\n\n  const onClickCancelEditTodo: MouseEventHandler<HTMLButtonElement> = () => {\n    setIsEditing(false);\n  };\n\n  if (isEditing)\n    return (\n      <form\n        className="flex gap-2 items-center justify-between"\n        onSubmit={onSubmitUpdateTodoText}\n      >\n        <input\n          className="p-1 grow"\n          type="text"\n          name="todoText"\n          defaultValue={todoText}\n          autoFocus\n        />\n        <div className="flex gap-2 grow-0">\n          <button type="submit" className="text-sm text-gray-600">\n            Save\n          </button>\n          <button\n            className="text-sm text-red-800"\n            onClick={onClickCancelEditTodo}\n          >\n            Cancel\n          </button>\n        </div>\n      </form>\n    );\n\n  return (\n    <div className="flex justify-between items-center">\n      <div className="flex items-center gap-2 p-1">\n        <input\n          type="checkbox"\n          checked={todoChecked}\n          onChange={onChangeTodoChecked}\n        />\n        <span className={todoChecked ? "line-through" : ""}>{todoText}</span>\n      </div>\n      <span className="flex place-items-center gap-2 text-sm">\n        <button className="text-gray-600" onClick={onClickEditTodo}>\n          Edit\n        </button>\n        <button className="text-red-800" onClick={onClickDeleteTodo}>\n          Delete\n        </button>\n      </span>\n    </div>\n  );\n}\n'})}),"\n",(0,d.jsxs)(o.p,{children:["Now create another new file at ",(0,d.jsx)(o.code,{children:"editors/todo-list-document/Todos.tsx"})," and give it this content:"]}),"\n",(0,d.jsx)(o.pre,{children:(0,d.jsx)(o.code,{className:"language-jsx",children:'import type { TodoItem } from "todo-tutorial/document-models/todo-list";\nimport { Todo } from "./Todo.js";\n\ntype Props = {\n  todos: TodoItem[];\n};\n\n/** Shows a list of the todo items in the selected todo list */\nexport function Todos({ todos }: Props) {\n  const hasTodos = todos.length > 0;\n\n  if (!hasTodos) {\n    return <p>Start adding things to your todo list</p>;\n  }\n\n  return (\n    <ul>\n      {todos.map((todo) => (\n        <li key={todo.id}>\n          <Todo todo={todo} />\n        </li>\n      ))}\n    </ul>\n  );\n}\n'})}),"\n",(0,d.jsxs)(o.p,{children:["And replace the content of your ",(0,d.jsx)(o.code,{children:"TodoList.tsx"})," file with this:"]}),"\n",(0,d.jsx)(o.pre,{children:(0,d.jsx)(o.code,{className:"language-jsx",children:'import { useSelectedTodoListDocument } from "todo-tutorial/document-models/todo-list";\nimport { EditTodoListName } from "./EditName.js";\nimport { Todos } from "./Todos.js";\nimport { AddTodo } from "./AddTodo.js";\nimport { CloseButton } from "./CloseButton.js";\n\n/** Displays the selected todo list */\nexport function TodoList() {\n  const [selectedTodoList] = useSelectedTodoListDocument();\n\n  if (!selectedTodoList) return null;\n\n  const todos = selectedTodoList.state.global.items;\n\n  return (\n    <div>\n      <section className="mb-4 flex gap-2 items-center">\n        <div className="grow">\n          <EditTodoListName />\n        </div>\n        <div className="flex-none">\n          <CloseButton />\n        </div>\n      </section>\n      <section className="mb-4">\n        <Todos todos={todos} />\n      </section>\n      <section>\n        <AddTodo />\n      </section>\n    </div>\n  );\n}\n'})}),"\n",(0,d.jsx)(o.pre,{children:(0,d.jsx)(o.code,{children:"editors/todo-list-editor/\n\u251c\u2500\u2500 components/\n\u2502   \u2514\u2500\u2500 EditName.tsx          # Auto-generated component for editing document name\n\u251c\u2500\u2500 editor.tsx                # Main editor component (do not change this)\n\u2514\u2500\u2500 module.ts                 # Editor module export (do not change this)\n"})}),"\n",(0,d.jsx)(o.h2,{id:"check-your-work",children:"Check your work"}),"\n",(0,d.jsx)(o.p,{children:"To make sure all works as expected, we should:"}),"\n",(0,d.jsxs)(o.ul,{children:["\n",(0,d.jsxs)(o.li,{children:["\n",(0,d.jsxs)(o.p,{children:["check types\nrun: ",(0,d.jsx)(o.code,{children:"pnpm tsc"})]}),"\n"]}),"\n",(0,d.jsxs)(o.li,{children:["\n",(0,d.jsxs)(o.p,{children:["check linting\nrun: ",(0,d.jsx)(o.code,{children:"pnpm lint"})]}),"\n"]}),"\n",(0,d.jsxs)(o.li,{children:["\n",(0,d.jsxs)(o.p,{children:["check tests\nrun: ",(0,d.jsx)(o.code,{children:"pnpm test"})]}),"\n"]}),"\n",(0,d.jsxs)(o.li,{children:["\n",(0,d.jsxs)(o.p,{children:["test in connect\nrun: ",(0,d.jsx)(o.code,{children:"pnpm connect"})," \u2014 you should now be able to open a ",(0,d.jsx)(o.code,{children:"TodoList"})," document and update all of the fields we defined in the ",(0,d.jsx)(o.code,{children:"TodoList"})," document model schema"]}),"\n"]}),"\n",(0,d.jsxs)(o.li,{children:["\n",(0,d.jsxs)(o.p,{children:["make sure your code matches the code in the completed step branch\nrun: ",(0,d.jsx)(o.code,{children:"git diff your-branch-name step-5-complete-added-basic-todo-list-document-editor-ui-components"})]}),"\n"]}),"\n"]}),"\n",(0,d.jsxs)(o.h2,{id:"up-next-generating-a-custom-drive-explorer-for-managing-our-todolist-documents",children:["Up next: generating a custom drive explorer for managing our ",(0,d.jsx)(o.code,{children:"TodoList"})," documents"]}),"\n",(0,d.jsx)(o.p,{children:'Next, we will generate a special kind of editor called a "drive editor" which we will use instead of the generic drive explorer.'})]})}function m(e={}){const{wrapper:o}={...(0,s.R)(),...e.components};return o?(0,d.jsx)(o,{...e,children:(0,d.jsx)(a,{...e})}):a(e)}function u(e,o){throw new Error("Expected "+(o?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}},7474:(e,o,t)=>{t.d(o,{R:()=>i,x:()=>r});var n=t(2155);const d={},s=n.createContext(d);function i(e){const o=n.useContext(s);return n.useMemo((function(){return"function"==typeof e?e(o):{...o,...e}}),[o,e])}function r(e){let o;return o=e.disableParentContext?"function"==typeof e.components?e.components(d):e.components||d:i(e.components),n.createElement(s.Provider,{value:o},e.children)}}}]);