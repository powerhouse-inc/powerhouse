"use strict";(self.webpackChunk_powerhousedao_academy=self.webpackChunk_powerhousedao_academy||[]).push([[6629],{5407:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>a,contentTitle:()=>r,default:()=>h,frontMatter:()=>s,metadata:()=>o,toc:()=>c});const o=JSON.parse('{"id":"academy/TodoListTutorial/GenerateTodoListDocumentModel","title":"Step 1 - Generate the TodoList document model","description":"Overview","source":"@site/docs/academy/10-TodoListTutorial/01-GenerateTodoListDocumentModel.md","sourceDirName":"academy/10-TodoListTutorial","slug":"/academy/TodoListTutorial/GenerateTodoListDocumentModel","permalink":"/academy/TodoListTutorial/GenerateTodoListDocumentModel","draft":false,"unlisted":false,"editUrl":"https://github.com/powerhouse-inc/powerhouse-docs/tree/dev/docs/academy/10-TodoListTutorial/01-GenerateTodoListDocumentModel.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{}}');var i=n(5723),d=n(7474);const s={},r="Step 1 - Generate the TodoList document model",a={},c=[{value:"Overview",id:"overview",level:2},{value:"Develop a single document model in Connect",id:"develop-a-single-document-model-in-connect",level:2},{value:"TodoList document specification",id:"todolist-document-specification",level:2},{value:"The document model state schema",id:"the-document-model-state-schema",level:2},{value:"Operation inputs and their schemas",id:"operation-inputs-and-their-schemas",level:2},{value:"Generating your document model code",id:"generating-your-document-model-code",level:2},{value:"Check your work",id:"check-your-work",level:2},{value:"Up next: reducers and operations",id:"up-next-reducers-and-operations",level:3}];function l(e){const t={a:"a",admonition:"admonition",br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",mdxAdmonitionTitle:"mdxAdmonitionTitle",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,d.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.header,{children:(0,i.jsxs)(t.h1,{id:"step-1---generate-the-todolist-document-model",children:["Step 1 - Generate the ",(0,i.jsx)(t.code,{children:"TodoList"})," document model"]})}),"\n",(0,i.jsx)(t.h2,{id:"overview",children:"Overview"}),"\n",(0,i.jsxs)(t.p,{children:["This tutorial guides you through creating a simplified version of a 'Powerhouse project' for a ",(0,i.jsx)(t.strong,{children:"To-do List"}),".",(0,i.jsx)(t.br,{}),"\n","A Powerhouse project primarily consists of a document model and its editor.\nAs your projects use-case expands you can add data-integrations or a specific drive-app as seen in the demo package."]}),"\n",(0,i.jsx)(t.p,{children:"For todays purpose, you'll be using Connect, our user-centric collaboration tool and Vetra Studio, the builder tooling through which developers can access and manage specifications of your project."}),"\n",(0,i.jsx)(t.h2,{id:"develop-a-single-document-model-in-connect",children:"Develop a single document model in Connect"}),"\n",(0,i.jsxs)(t.p,{children:["Once in the project directory, run the ",(0,i.jsx)(t.code,{children:"pnpm connect"})," command to start a local instance of the Connect application. This allows you to start your document model specification document.\nRun the following command to start the Connect application:"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:"pnpm connect\n"})}),"\n",(0,i.jsx)(t.p,{children:"The Connect application will start and you will see the following output:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:"  \u279c  Local:   http://localhost:3000/\n  \u279c  Network: http://192.168.5.110:3000/\n  \u279c  press h + enter to show help\n"})}),"\n",(0,i.jsxs)(t.p,{children:["A new browser window will open and you will see the Connect application. If it doesn't open automatically, you can open it manually by navigating to ",(0,i.jsx)(t.code,{children:"http://localhost:3000/"})," in your browser. You will see your local drive and a button to create a new drive."]}),"\n",(0,i.jsxs)(t.admonition,{type:"tip",children:[(0,i.jsx)(t.mdxAdmonitionTitle,{}),(0,i.jsx)(t.p,{children:"If you local drive is not present navigate into Settings in the bottom left corner. Settings > Danger Zone > Clear Storage.\nClear the storage of your localhost application as it might has an old session cached."})]}),"\n",(0,i.jsxs)(t.ol,{start:"4",children:["\n",(0,i.jsxs)(t.li,{children:["Move into your local drive.",(0,i.jsx)(t.br,{}),"\n","Create a new document model by clicking the ",(0,i.jsx)(t.code,{children:"DocumentModel"})," button, found in the 'New Document' section at the bottom of the page. Name your document ",(0,i.jsx)(t.code,{children:"Todo List"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(t.p,{children:["If you've followed the steps correctly, you'll have an empty ",(0,i.jsx)(t.code,{children:"TodoList"})," document where you can define the ",(0,i.jsx)(t.strong,{children:"'Document Specifications'"}),"."]}),"\n",(0,i.jsx)(t.h2,{id:"todolist-document-specification",children:"TodoList document specification"}),"\n",(0,i.jsx)(t.p,{children:"To start, fill in the following details for your new document model:"}),"\n",(0,i.jsxs)(t.p,{children:["Name: ",(0,i.jsx)(t.code,{children:"Todo List"}),"\nDocument type: ",(0,i.jsx)(t.code,{children:"powerhouse/todo-list"}),"\nAuthor name: Powerhouse\nWebsite URL: ",(0,i.jsx)(t.a,{href:"https://powerhouse.inc",children:"https://powerhouse.inc"})]}),"\n",(0,i.jsx)(t.p,{children:"It's important that you use these exact details so that your generated code matches the generated code in the tutorial repository."}),"\n",(0,i.jsxs)(t.p,{children:["We'll continue with this project to teach you how to create a document model specification and later an editor for your document model. We use the ",(0,i.jsx)(t.strong,{children:"GraphQL Schema Definition Language"})," (SDL) to define the schema for the document model.",(0,i.jsx)(t.br,{}),"\n","Below, you can see the SDL for the ",(0,i.jsx)(t.code,{children:"TodoList"})," document model."]}),"\n",(0,i.jsx)(t.admonition,{type:"info",children:(0,i.jsxs)(t.p,{children:["This schema defines the ",(0,i.jsx)(t.strong,{children:"data structure"})," of the document model and the types involved in its operations, which are detailed further as input types.\nDocuments in Powerhouse leverage ",(0,i.jsx)(t.strong,{children:"event sourcing principles"}),", where every state transition is represented by an operation. GraphQL input types describe operations, ensuring that user intents are captured effectively. These operations detail the parameters needed for state transitions. The use of GraphQL aligns these transitions with explicit, validated, and reproducible commands."]})}),"\n",(0,i.jsx)(t.h2,{id:"the-document-model-state-schema",children:"The document model state schema"}),"\n",(0,i.jsx)(t.p,{children:"First, let's add a graphql type that represents an individual item in a todo list document. A todo item has an ID, text, and can be either checked or unchecked."}),"\n",(0,i.jsxs)(t.p,{children:["Add this underneath the boilerplate ",(0,i.jsx)(t.code,{children:"TodoListState"})," type you see in the Global State Schema text editor."]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-graphql",children:"# Defines a GraphQL type for a single to-do item\ntype TodoItem {\n  id: OID! # Unique identifier for each to-do item\n  text: String! # The text description of the to-do item\n  checked: Boolean! # Status of the to-do item (checked/unchecked)\n}\n"})}),"\n",(0,i.jsxs)(t.p,{children:["Now update the ",(0,i.jsx)(t.code,{children:"TodoListState"})," type to use our new type by replacing the boilerplate with this:"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-graphql",children:"type TodoListState {\n  items: [TodoItem!]!\n}\n"})}),"\n",(0,i.jsx)(t.p,{children:"The final result in your editor should look like this:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-graphql",children:"type TodoListState {\n  items: [TodoItem!]!\n}\n\n# Defines a GraphQL type for a single to-do item\ntype TodoItem {\n  id: OID! # Unique identifier for each to-do item\n  text: String! # The text description of the to-do item\n  checked: Boolean! # Status of the to-do item (checked/unchecked)\n}\n"})}),"\n",(0,i.jsx)(t.p,{children:'With our state schema defined, go ahead and click the "Sync with schema" button underneath "Global State Initial Value". This will set the initial state for the documents you create with this model based on the schema you defined.'}),"\n",(0,i.jsx)(t.p,{children:"Your initial value field should now look like this:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-json",children:'{\n  "items": []\n}\n'})}),"\n",(0,i.jsx)(t.h2,{id:"operation-inputs-and-their-schemas",children:"Operation inputs and their schemas"}),"\n",(0,i.jsxs)(t.p,{children:["We've defined the shape for the state of our ",(0,i.jsx)(t.code,{children:"TodoList"})," documents, but we also need to be able to update them."]}),"\n",(0,i.jsx)(t.p,{children:"Documents are updated by dispatching actions, which are applied to documents as operations."}),"\n",(0,i.jsx)(t.p,{children:"We define modules to group sets of operations together. In this simple case, we will only need one module."}),"\n",(0,i.jsxs)(t.p,{children:["Add a new module for our ",(0,i.jsx)(t.code,{children:"todos"})," operations by typing ",(0,i.jsx)(t.code,{children:"todos"}),' in the "Add new module" input and pressing enter.']}),"\n",(0,i.jsx)(t.p,{children:"We need to add three different operations to this module:"}),"\n",(0,i.jsxs)(t.ol,{children:["\n",(0,i.jsx)(t.li,{children:"add todo item"}),"\n",(0,i.jsx)(t.li,{children:"update todo item"}),"\n",(0,i.jsx)(t.li,{children:"delete todo item"}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:"Let's start with adding todos."}),"\n",(0,i.jsx)(t.p,{children:"When we add a new todo, the only input we need to provide is the text. Creating the ID will be handled later in our reducer code, and todos always start as unchecked by default."}),"\n",(0,i.jsxs)(t.p,{children:["type ",(0,i.jsx)(t.code,{children:"add todo item"}),' in the "Add new operation" input and press enter.']}),"\n",(0,i.jsxs)(t.p,{children:["You will see your new operation with the name ",(0,i.jsx)(t.code,{children:"ADD_TODO_ITEM"})," (we automatically handle changing the casing to the required CONSTANT_CASE)."]}),"\n",(0,i.jsx)(t.p,{children:"You will also see a boilerplate placeholder graphql input."}),"\n",(0,i.jsx)(t.p,{children:"Update the graphql input like so:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-graphql",children:"input AddTodoItemInput {\n  text: String!\n}\n"})}),"\n",(0,i.jsx)(t.p,{children:"Next let's handle updating todo items."}),"\n",(0,i.jsxs)(t.p,{children:["Type ",(0,i.jsx)(t.code,{children:"update todo item"}),' in the "Add new operation" input and press enter.']}),"\n",(0,i.jsxs)(t.p,{children:["For updating items, we will need to provide an ",(0,i.jsx)(t.code,{children:"id"})," so we know which one to update. We can use the same operation to update the text or the checked state, so both of these fields are optional (no ! on the field)."]}),"\n",(0,i.jsxs)(t.p,{children:["Update the ",(0,i.jsx)(t.code,{children:"UpdateTodoItemInput"})," to be like so:"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-graphql",children:"input UpdateTodoItemInput {\n  id: OID!\n  text: String\n  checked: Boolean\n}\n"})}),"\n",(0,i.jsx)(t.p,{children:"Finally, we can handle the delete item operation."}),"\n",(0,i.jsxs)(t.p,{children:["type ",(0,i.jsx)(t.code,{children:"delete todo item"}),' in the "Add new operation" input.']}),"\n",(0,i.jsxs)(t.p,{children:["For deleting items, all we need is an ",(0,i.jsx)(t.code,{children:"id"}),"."]}),"\n",(0,i.jsxs)(t.p,{children:["Update your ",(0,i.jsx)(t.code,{children:"DeleteTodoItemInput"})," to be like this:"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-graphql",children:"input DeleteTodoItemInput {\n  id: OID!\n}\n"})}),"\n",(0,i.jsxs)(t.p,{children:["Once you have added all the input operations, click the ",(0,i.jsx)(t.code,{children:"Export"})," button at the top right of the editor to save the document model specification document to your local machine. Ideally, you should save your file in the root of your repository with the name ",(0,i.jsx)(t.code,{children:"todo-list.phd"})]}),"\n",(0,i.jsx)(t.h2,{id:"generating-your-document-model-code",children:"Generating your document model code"}),"\n",(0,i.jsx)(t.p,{children:"With our newly created document model, we can run the codegen to generate the rest of the code for it."}),"\n",(0,i.jsxs)(t.p,{children:["To run the codegen, you use the ",(0,i.jsx)(t.code,{children:"generate"})," command with a path to the file you just exported."]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:"pnpm generate ./todo-list.phd\n"})}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"NOTE:"})," this generated code contains values that will always be different for each generated document model, like module ids for example. For the purposes of this tutorial, we recommend that you instead use the reference example that we have already included in the repo for you \u2014 this will make your generated code look exactly the same as the generated code in the branches in the repo, and your diffs will match exactly."]}),"\n",(0,i.jsx)(t.p,{children:"To use our reference example, run:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:"pnpm generate ./todo-list.phdm.phd\n"})}),"\n",(0,i.jsx)(t.p,{children:"This will overwrite your generated code with code that is identical to the branches in this repository."}),"\n",(0,i.jsx)(t.h2,{id:"check-your-work",children:"Check your work"}),"\n",(0,i.jsx)(t.p,{children:"To make sure all works as expected, we should:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsxs)(t.p,{children:["check types\nrun: ",(0,i.jsx)(t.code,{children:"pnpm tsc"})]}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsxs)(t.p,{children:["check linting\nrun: ",(0,i.jsx)(t.code,{children:"pnpm lint"})]}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsxs)(t.p,{children:["check tests\nrun: ",(0,i.jsx)(t.code,{children:"pnpm test"})]}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsxs)(t.p,{children:["make sure your code matches the code in the completed step branch\nrun: ",(0,i.jsx)(t.code,{children:"git diff your-branch-name step-1-complete-generated-todo-list-document-model"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(t.h3,{id:"up-next-reducers-and-operations",children:"Up next: reducers and operations"}),"\n",(0,i.jsxs)(t.p,{children:["Up next, you'll learn how to implement the runtime logic and components that will use the ",(0,i.jsx)(t.code,{children:"TodoList"})," document model specification you've just created and exported."]})]})}function h(e={}){const{wrapper:t}={...(0,d.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},7474:(e,t,n)=>{n.d(t,{R:()=>s,x:()=>r});var o=n(2155);const i={},d=o.createContext(i);function s(e){const t=o.useContext(d);return o.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),o.createElement(d.Provider,{value:t},e.children)}}}]);